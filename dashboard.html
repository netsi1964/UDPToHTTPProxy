<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <title>Flight monitor</title>
  <link href="http://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/css/bootstrap.min.css" rel="stylesheet" />
  <style>
    html,
    body {
      margin: 0;
      padding: 0;
    }

    #map-canvas {
      height: 100vh;
      width: 100%;
    }
  </style>
</head>

<body>
  <div id="map-canvas"></div>
  <div class="container fluid">
    <div class="row">
      <h1>Flight monitor</h1>
    </div>
    <div class="row">
      <div class="col-md-12">
        <h2>Current position</h2>
        <div class="pos"></div>
      </div>

    </div>

  </div>
  <script src="http://cdnjs.cloudflare.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>
  <script src="http://maps.google.com/maps/api/js"></script>
  <script>
    var flightPath = [],
      mapsFlightPath,
      $pos = $(".pos");

    function getFlightPosition(sURL, sPort) {
      sURL = (typeof sURL !== "undefined") ? sURL : "http://localhost";
      sPort = (typeof sPort !== "undefined") ? sPort : "8080";
      $.getJSON(sURL + ":" + sPort, function(data) {

        if (data.message.length > 0) {
          // lat,long,altitude
          var aTemp = data.message.split(",");

          var rawLatLng = {
            lat: parseFloat(aTemp[0]),
            lng: parseFloat(aTemp[1])
          };
          myLatLng = new google.maps.LatLng(rawLatLng);
          flightPath.push(rawLatLng);

          map.panTo(myLatLng, animate = true);

          mapsFlightPath = new google.maps.Polyline({
            path: flightPath,
            geodesic: true,
            strokeColor: 'rgba(100,100,0,.5)',
            strokeOpacity: 1,
            strokeWeight: 9
          });
          mapsFlightPath.setMap(map);
          $pos.html("<code>lat:" + rawLatLng.lat + ",<br>lng:" + rawLatLng.lng + "</code>");
        }
      });

      setTimeout(getFlightPosition, 2000);
    }

    var lat = -34;
    var lng = 150;
    var map;

    function initializeMap() {
      var mapOptions = {
        zoom: 10,
        center: new google.maps.LatLng(lat, lng),
        mapTypeId: google.maps.MapTypeId.ROADMAP
      };
      map = new google.maps.Map(document.getElementById('map-canvas'),
        mapOptions);

      getFlightPosition();

    }
    google.maps.event.addDomListener(window, 'load', initializeMap);
  </script>
</body>

</html>
